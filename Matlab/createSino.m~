function sinogram = createSino(filePath, photoName, binning, shift, angles, visualize)
    addpath(filePath);

    bkgSize = 2^7;

    sinogram = zeros(2240 / binning, 360);

    figure(1)
    clf
    for k = 1:361
        % Display progress
        if mod(k,10) == 0
            disp(k)
        end
        
        % Load the picture
        fileName = [photoName '_' sprintf('%03d', k) '.tif'];
        im = double(imread(fileName));
        background = im(1:bkgSize/binning,1:bkgSize/binning);
        
        % Shift the picture to center it based on rotation axis
        im = circshift(im, shift, 1);
        
        % Do binning
        im = bin_projection(im, binning);

        I0 = mean(background(:));
        I = im(end/2,:);

        lineIntegral = -log(I./I0);
        sinogram(:,k - 1) = lineIntegral;

        if visualize
            sinogram2 = sinogram;
            sinogram2(:,k - 1) = max(sinogram(:));
            
            im2 = im;
            im2(end/2,:) = max(im(:));
            subplot(1,2,1)
            imshow(im2,[])
            colormap gray

            subplot(1,2,2)
            imagesc(sinogram2)
            colormap gray
            pause(0.1)
        end
    end
end

